<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>ç†Šç†Šå¡”ç¾…å åœ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    * {
      box-sizing: border-box;
    }
    body {
      margin: 0;
      padding: 0;
      font-family: "Noto Sans TC", -apple-system, BlinkMacSystemFont, sans-serif;
      background: linear-gradient(180deg, #2d254a, #6a4f9c, #f9e4c8);
      color: #fff;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      min-height: 100vh;
    }
    .game-wrap {
      max-width: 480px;
      width: 100%;
      padding: 16px;
      margin-top: 16px;
      position: relative;
      overflow: hidden;
    }
    .card-panel {
      background: rgba(255, 247, 230, 0.95);
      border-radius: 18px;
      border: 2px solid #f7dba5;
      box-shadow: 0 4px 14px rgba(0,0,0,0.25);
      padding: 18px 14px 20px;
      color: #4a3450;
    }
    h1 {
      margin: 0 0 4px;
      font-size: 22px;
      text-align: center;
      letter-spacing: 0.15em;
    }
    .subtitle {
      text-align: center;
      font-size: 13px;
      color: #7c5c88;
      margin-bottom: 12px;
    }
    .star-divider {
      text-align: center;
      font-size: 16px;
      margin-bottom: 10px;
    }
    .btn-bar {
      text-align: center;
      margin-bottom: 10px;
    }
    button {
      border: none;
      border-radius: 999px;
      padding: 10px 22px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      background: linear-gradient(135deg, #ffcf5f, #ff9f7b);
      color: #4a2a18;
      box-shadow: 0 3px 8px rgba(0,0,0,0.25);
      transition: transform 0.1s ease, box-shadow 0.1s ease, opacity 0.2s ease;
    }
    button:active {
      transform: translateY(1px) scale(0.98);
      box-shadow: 0 1px 4px rgba(0,0,0,0.3);
    }
    button:disabled {
      opacity: 0.6;
      cursor: default;
      box-shadow: none;
    }

    /* ä¸‰å¼µç‰Œå€åŸŸ */
    .table {
      margin-top: 10px;
      display: flex;
      justify-content: space-between;
      gap: 6px;
    }
    .slot-title {
      text-align: center;
      font-size: 12px;
      color: #8f6c9b;
      margin-bottom: 4px;
    }
    .card-slot {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    /* å¡ç‰‡æœ¬é«” */
    .card {
      width: 90px;
      height: 140px;
      perspective: 900px;
      cursor: pointer;
      opacity: 0;
      transform: translateY(20px) scale(0.9);
      pointer-events: none;
    }
    .card.show {
      animation: cardEnter 0.45s forwards;
    }
    .card-inner {
      width: 100%;
      height: 100%;
      position: relative;
      transform-style: preserve-3d;
      transition: transform 0.6s ease;
    }
    .card.flipped .card-inner {
      transform: rotateY(180deg);
    }
    .card-face {
      position: absolute;
      inset: 0;
      border-radius: 12px;
      backface-visibility: hidden;
      box-shadow: 0 4px 9px rgba(0,0,0,0.25);
    }
    .card-back {
      background: radial-gradient(circle at 30% 20%, #ffeaa7, #f0932b, #e056fd);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 30px;
      color: #fffdf0;
      border: 2px solid rgba(255,255,255,0.85);
      position: relative;
      overflow: hidden;
    }
    .card-back::before {
      content: "â˜…";
      position: absolute;
      font-size: 48px;
      opacity: 0.2;
      top: -8px;
      right: 8px;
    }
    .card-front {
      transform: rotateY(180deg);
      background: #fff9ef;
      border: 2px solid #f3c79b;
      padding: 10px 7px;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
    }
    /* é€†ä½æ™‚ï¼Œé‚Šæ¡†é¡è‰²ç¨å¾®ä¸åŒ */
    .card.is-reversed .card-front {
      border-color: #b895f5;
    }
    .card-name {
      font-size: 13px;
      font-weight: 700;
      text-align: center;
      color: #7a3f5f;
      margin-bottom: 4px;
    }
    .card-tag {
      font-size: 11px;
      text-align: center;
      color: #c77a68;
      margin-bottom: 6px;
    }
    .card-meaning {
      font-size: 11px;
      line-height: 1.4;
      color: #5c3b4c;
      flex: 1;
    }
    .card-icon {
      text-align: center;
      font-size: 18px;
      margin-top: 4px;
    }

    @keyframes cardEnter {
      from { opacity: 0; transform: translateY(20px) scale(0.9); }
      to   { opacity: 1; transform: translateY(0) scale(1); }
    }

    /* ç†Šç†Šå°è©±æ¡† */
    .bear-dialog {
      position: fixed;
      left: 50%;
      bottom: 8%;
      transform: translateX(-50%);
      max-width: 460px;
      width: calc(100% - 32px);
      display: flex;
      align-items: flex-start;
      gap: 10px;
      background: rgba(255, 247, 230, 0.98);
      border-radius: 18px;
      border: 2px solid #f5d3a6;
      box-shadow: 0 6px 18px rgba(0,0,0,0.35);
      padding: 10px 12px 12px;
      color: #4b3044;
      z-index: 30;
      animation: bearPop 0.4s ease-out;
    }
    .bear-dialog.hidden {
      display: none;
    }
    .bear-avatar {
      width: 42px;
      height: 42px;
      border-radius: 50%;
      background: radial-gradient(circle at 30% 20%, #ffeaa7, #ff9f7b);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 26px;
      flex-shrink: 0;
    }
    .bear-text {
      flex: 1;
      font-size: 13px;
    }
    .bear-title {
      font-weight: 700;
      margin-bottom: 4px;
      color: #8a4d5c;
    }
    .bear-message {
      font-size: 13px;
      line-height: 1.5;
      white-space: pre-line;
      margin-bottom: 6px;
    }
    .bear-actions {
      text-align: right;
    }
    .bear-actions button {
      font-size: 12px;
      padding: 6px 14px;
      box-shadow: none;
    }
    @keyframes bearPop {
      from { transform: translate(-50%, 40px) scale(0.9); opacity: 0; }
      to   { transform: translate(-50%, 0) scale(1); opacity: 1; }
    }

    /* æ˜Ÿæ˜Ÿç²’å­å±¤ */
    .star-layer {
      pointer-events: none;
      position: absolute;
      inset: 0;
      overflow: hidden;
      z-index: -1;
    }
    .star {
      position: absolute;
      width: 4px;
      height: 4px;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.9);
      box-shadow: 0 0 6px rgba(255,255,255,0.9);
      animation: starFloat 1.4s ease-out forwards;
      opacity: 0;
    }
    @keyframes starFloat {
      0% {
        transform: translate3d(0, 10px, 0) scale(0.3);
        opacity: 0;
      }
      20% {
        opacity: 1;
      }
      100% {
        transform: translate3d(0, -40px, 0) scale(1);
        opacity: 0;
      }
    }

    /* å°æç¤ºæ–‡å­— */
    .hint {
      text-align: center;
      font-size: 11px;
      color: #edd2f4;
      margin-top: 6px;
    }

    @media (max-width: 400px) {
      .card {
        width: 80px;
        height: 124px;
      }
    }
  </style>
</head>
<body>
  <div class="game-wrap">
    <!-- æ˜Ÿæ˜Ÿç²’å­å±¤ -->
    <div class="star-layer" id="starLayer"></div>

    <div class="card-panel">
      <h1>ç†Šç†Šå¡”ç¾…å åœ</h1>
      <div class="subtitle">æ·±å‘¼å¸ 3 ç§’ï¼Œå¿ƒè£¡é»˜å¿µå•é¡Œï¼Œç„¶å¾Œé»ä¸‹æŒ‰éˆ•ã€‚</div>
      <div class="star-divider">âœ¦ âœ¦ âœ¦</div>

      <div class="btn-bar">
        <button id="startBtn">é–‹å§‹å åœ</button>
      </div>

      <div class="table">
        <!-- éå» -->
        <div class="card-slot" data-position="past">
          <div class="slot-title">éå»</div>
          <div class="card">
            <div class="card-inner">
              <div class="card-face card-back">â˜…</div>
              <div class="card-face card-front">
                <div class="card-name"></div>
                <div class="card-tag"></div>
                <div class="card-meaning"></div>
                <div class="card-icon"></div>
              </div>
            </div>
          </div>
        </div>
        <!-- ç¾åœ¨ -->
        <div class="card-slot" data-position="present">
          <div class="slot-title">ç¾åœ¨</div>
          <div class="card">
            <div class="card-inner">
              <div class="card-face card-back">â˜…</div>
              <div class="card-face card-front">
                <div class="card-name"></div>
                <div class="card-tag"></div>
                <div class="card-meaning"></div>
                <div class="card-icon"></div>
              </div>
            </div>
          </div>
        </div>
        <!-- æœªä¾† -->
        <div class="card-slot" data-position="future">
          <div class="slot-title">æœªä¾†</div>
          <div class="card">
            <div class="card-inner">
              <div class="card-face card-back">â˜…</div>
              <div class="card-face card-front">
                <div class="card-name"></div>
                <div class="card-tag"></div>
                <div class="card-meaning"></div>
                <div class="card-icon"></div>
              </div>
            </div>
          </div>
        </div>
      </div><!-- .table -->
    </div><!-- .card-panel -->

    <div class="hint">æç¤ºï¼šæŒ‰ã€Œé–‹å§‹å åœã€å¾Œï¼Œä¾åºé»ä¸‰å¼µç‰Œç¿»é–‹å”· âœ¨</div>
  </div><!-- .game-wrap -->

  <!-- ç†Šç†Šå°è©±æ¡† -->
  <div id="bearDialog" class="bear-dialog hidden">
    <div class="bear-avatar">ğŸ»</div>
    <div class="bear-text">
      <div class="bear-title">æ‘é•·ç†Šç†Šçš„å°æé†’</div>
      <div class="bear-message" id="bearMessage">
        ä»Šå¤©çš„èƒ½é‡æ­£åœ¨æº–å‚™ä¸­â€¦
      </div>
      <div class="bear-actions">
        <button id="againBtn">å†å ä¸€æ¬¡</button>
      </div>
    </div>
  </div>

  <script>
    // 22 å¼µå¤§ç§˜å„€ï¼šåç¨±ã€ä¸»é¡Œã€æ­£ä½ã€é€†ä½ï¼ˆç°¡ç‰ˆè§£é‡‹ï¼‰
    const tarotCards = [
      {
        name: "æ„šè€…",
        tag: "æ–°çš„é–‹å§‹ãƒ»è‡ªç”±ãƒ»æ—…ç¨‹",
        icon: "ğŸ’",
        upright: "æ­£ä½ï¼šæ–°çš„æ—…ç¨‹ã€å‹‡æ•¢å˜—è©¦ã€å¸¶è‘—å¥½å¥‡å¿ƒå¾€å‰èµ°ï¼Œå…è¨±è‡ªå·±ç•¶æ–°æ‰‹ã€‚",
        reversed: "é€†ä½ï¼šè¡å‹•æˆ–éåº¦é€ƒé¿ï¼Œæé†’ä½ åœ¨å†’éšªå‰å…ˆåšå¥½åŸºæœ¬æº–å‚™ã€‚"
      },
      {
        name: "é­”è¡“å¸«",
        tag: "è¡Œå‹•ãƒ»å‰µé€ ãƒ»å°ˆæ³¨",
        icon: "âœ¨",
        upright: "æ­£ä½ï¼šä½ å…¶å¯¦å·²ç¶“æœ‰è¶³å¤ çš„å·¥å…·èˆ‡èƒ½åŠ›ï¼Œå¯ä»¥é–‹å§‹å¯¦éš›è¡Œå‹•ã€æŠŠæƒ³æ³•è®Šæˆç¾å¯¦ã€‚",
        reversed: "é€†ä½ï¼šåŠ›é‡æœ‰é»åˆ†æ•£ï¼Œæé†’ä½ åˆ¥ä¸€å¿ƒå¤šç”¨ï¼ŒæŠŠæ³¨æ„åŠ›æ”¶å›åˆ°çœŸæ­£é‡è¦çš„äº‹ã€‚"
      },
      {
        name: "å¥³ç¥­å¸",
        tag: "ç›´è¦ºãƒ»æ½›æ„è­˜",
        icon: "ğŸŒ™",
        upright: "æ­£ä½ï¼šå®‰éœä¸‹ä¾†ï¼Œä½ çš„ç›´è¦ºæœƒçµ¦ä½ ç­”æ¡ˆï¼Œç›¸ä¿¡å¿ƒè£¡é‚£å€‹æº«æŸ”è€Œå …å®šçš„è²éŸ³ã€‚",
        reversed: "é€†ä½ï¼šæƒ³å¤ªå¤šã€æƒ…ç·’å¤ªäº‚ï¼Œå…ˆç…§é¡§å¥½è‡ªå·±ï¼Œå†ä¾†è§£ç­”åˆ¥äººçš„å•é¡Œã€‚"
      },
      {
        name: "çš‡å",
        tag: "æ»‹é¤Šãƒ»ç¾æ„Ÿãƒ»è±ç››",
        icon: "ğŸ‘‘",
        upright: "æ­£ä½ï¼šé©åˆå¥½å¥½ç…§é¡§èº«é«”èˆ‡ç”Ÿæ´»ç’°å¢ƒï¼Œäº«å—å‰µä½œã€ç¾æ„Ÿèˆ‡è¢«æ„›çš„æ„Ÿè¦ºã€‚",
        reversed: "é€†ä½ï¼šéåº¦ä»˜å‡ºã€å¿½ç•¥è‡ªå·±ï¼Œæé†’ä½ å…ˆæŠŠä¸€éƒ¨åˆ†æ„›ç•™çµ¦è‡ªå·±ã€‚"
      },
      {
        name: "çš‡å¸",
        tag: "çµæ§‹ãƒ»è²¬ä»»ãƒ»ç©©å®š",
        icon: "ğŸ›ï¸",
        upright: "æ­£ä½ï¼šéœ€è¦ä½ ç«™å‡ºä¾†åšæ±ºå®šã€è¨­å®šç•Œç·šï¼Œå»ºç«‹ç©©å®šçš„è¦å‰‡èˆ‡ç§©åºã€‚",
        reversed: "é€†ä½ï¼šæ§åˆ¶æ„Ÿå¤ªå¼·æˆ–å¤ªåƒµç¡¬ï¼Œå¯ä»¥å¤šä¸€é»å½ˆæ€§èˆ‡å‚¾è½ã€‚"
      },
      {
        name: "æ•™çš‡",
        tag: "å­¸ç¿’ãƒ»è¦ç¯„ãƒ»å‚³æ‰¿",
        icon: "ğŸ“–",
        upright: "æ­£ä½ï¼šé©åˆå‘è€å¸«ã€å°ˆæ¥­äººå£«è«‹æ•™ï¼Œä¹Ÿä»£è¡¨å®ˆè¦å‰‡ã€è·Ÿéš¨æ—¢æœ‰çš„è·¯ç·šã€‚",
        reversed: "é€†ä½ï¼šéåº¦åœ¨æ„åˆ¥äººæœŸå¾…ï¼Œæé†’ä½ ä¹Ÿè¦è½è½è‡ªå·±çœŸæ­£ç›¸ä¿¡çš„æ˜¯ä»€éº¼ã€‚"
      },
      {
        name: "æˆ€äºº",
        tag: "é—œä¿‚ãƒ»é¸æ“‡ãƒ»é€£çµ",
        icon: "ğŸ’–",
        upright: "æ­£ä½ï¼šé‡è¦çš„é—œä¿‚æˆ–åˆä½œä¾†åˆ°çœ¼å‰ï¼Œè¦çœŸèª æºé€šã€åšå‡ºç¬¦åˆå…§å¿ƒçš„é¸æ“‡ã€‚",
        reversed: "é€†ä½ï¼šèª¤æœƒã€çŒ¶è±«æˆ–ä¸å¹³è¡¡ï¼Œé©åˆåœä¸‹ä¾†é‡æ–°ç¢ºèªå½¼æ­¤çš„éœ€è¦ã€‚"
      },
      {
        name: "æˆ°è»Š",
        tag: "å‰é€²ãƒ»æ„å¿—ãƒ»çªç ´",
        icon: "ğŸ‡",
        upright: "æ­£ä½ï¼šé©åˆå‹‡æ•¢å¾€å‰è¡ã€é¢å°æŒ‘æˆ°ï¼Œå°ˆæ³¨åœ¨è‡ªå·±çš„æ–¹å‘ä¸Šã€‚",
        reversed: "é€†ä½ï¼šæ–¹å‘æ„Ÿæ··äº‚æˆ–å¤ªæ€¥èºï¼Œå…ˆèª¿æ•´ç¯€å¥èˆ‡ç›®æ¨™å†å‡ºç™¼ã€‚"
      },
      {
        name: "åŠ›é‡",
        tag: "æº«æŸ”çš„å …å®šãƒ»å‹‡æ°£",
        icon: "ğŸ¦",
        upright: "æ­£ä½ï¼šç”¨æº«æŸ”è€Œç©©å®šçš„æ–¹å¼ï¼Œå®‰æ’«è‡ªå·±çš„æƒ…ç·’ï¼Œä¹Ÿèƒ½å®‰æ’«åˆ¥äººçš„ä¸å®‰ã€‚",
        reversed: "é€†ä½ï¼šå¿ƒè£¡æœ‰äº›ç–²ç´¯æˆ–è‡ªæˆ‘æ‡·ç–‘ï¼Œæé†’ä½ ä¼‘æ¯å’Œè‡ªæˆ‘è‚¯å®šå¾ˆé‡è¦ã€‚"
      },
      {
        name: "éš±è€…",
        tag: "ç¨è™•ãƒ»å…§åœ¨æ¢ç´¢",
        icon: "ğŸ•¯ï¸",
        upright: "æ­£ä½ï¼šéœ€è¦ä¸€æ®µå®‰éœçš„æ™‚é–“ï¼Œæ•´ç†å¿ƒæƒ…èˆ‡æƒ³æ³•ï¼Œè½è½è‡ªå·±çœŸæ­£çš„è²éŸ³ã€‚",
        reversed: "é€†ä½ï¼šå¤ªå­¤å–®æˆ–å°é–‰ï¼Œé©åˆæ…¢æ…¢æ‰“é–‹ä¸€é»é»ï¼Œè®“ä¿¡ä»»çš„äººé è¿‘ã€‚"
      },
      {
        name: "å‘½é‹ä¹‹è¼ª",
        tag: "è½‰æŠ˜ãƒ»æ©Ÿé‹ãƒ»å‘¨æœŸ",
        icon: "ğŸ¡",
        upright: "æ­£ä½ï¼šé‹å‹¢æ­£åœ¨è½‰å‹•ï¼Œæœ‰æ–°çš„æ©Ÿæœƒæˆ–æ”¹è®Šå‡ºç¾ï¼Œæ“æŠ±è®ŠåŒ–ã€‚",
        reversed: "é€†ä½ï¼šäº‹æƒ…å¡å¡çš„ï¼Œæé†’ä½ å…ˆèª¿æ•´å¿ƒæ…‹ï¼Œè€å¿ƒç­‰å¾…æ™‚æ©Ÿå†å‡ºæ‰‹ã€‚"
      },
      {
        name: "æ­£ç¾©",
        tag: "å…¬å¹³ãƒ»æ±ºç­–ãƒ»èª å¯¦",
        icon: "âš–ï¸",
        upright: "æ­£ä½ï¼šéœ€è¦ç†æ€§åˆ†æã€é¢å°çœŸç›¸ï¼Œåšå‡ºå°è‡ªå·±èˆ‡ä»–äººéƒ½è² è²¬çš„é¸æ“‡ã€‚",
        reversed: "é€†ä½ï¼šè¦ºå¾—ä¸å…¬å¹³æˆ–è¢«èª¤è§£ï¼Œé©åˆæŠŠè©±èªªæ¸…æ¥šã€ä¹Ÿæª¢è¦–è‡ªå·±çš„ç«‹å ´ã€‚"
      },
      {
        name: "åŠäºº",
        tag: "æš«åœãƒ»æ›è§’åº¦",
        icon: "ğŸªœ",
        upright: "æ­£ä½ï¼šæš«æ™‚çš„åœæ»¯æ˜¯ç‚ºäº†çœ‹è¦‹æ–°çš„è§€é»ï¼Œæ…¢ä¸‹ä¾†åè€Œèƒ½èµ°å¾—æ›´ç©©ã€‚",
        reversed: "é€†ä½ï¼šä¸€ç›´å¡åœ¨åŒä¸€å€‹ä½ç½®ï¼Œæé†’ä½ å¯ä»¥è©¦è‘—é¬†æ‰‹ã€æ”¹è®Šçœ‹äº‹æƒ…çš„æ–¹å¼ã€‚"
      },
      {
        name: "æ­»ç¥",
        tag: "çµæŸãƒ»è½‰åŒ–ãƒ»é‡ç”Ÿ",
        icon: "â˜ ï¸",
        upright: "æ­£ä½ï¼šä¸€å€‹éšæ®µè¦å‘Šä¸€æ®µè½äº†ï¼Œç‚ºæ–°çš„é–‹å§‹é¨°å‡ºç©ºé–“ã€‚",
        reversed: "é€†ä½ï¼šå®³æ€•çµæŸæˆ–æ”¹è®Šï¼Œåè€Œè®“è‡ªå·±æ›´è¾›è‹¦ï¼Œè©¦è‘—å…è¨±ã€ŒèˆŠçš„ã€æ…¢æ…¢é›¢é–‹ã€‚"
      },
      {
        name: "ç¯€åˆ¶",
        tag: "å¹³è¡¡ãƒ»èª¿å’Œãƒ»é©é‡",
        icon: "ğŸ’§",
        upright: "æ­£ä½ï¼šæ‰¾åˆ°å‰›å‰›å¥½çš„ç¯€å¥ï¼Œä¸ç”¨æ¥µç«¯ï¼Œç”¨æº«å’Œçš„æ–¹å¼èª¿æ•´ç”Ÿæ´»èˆ‡é—œä¿‚ã€‚",
        reversed: "é€†ä½ï¼šéåº¦å¿™ç¢Œæˆ–éåº¦æ”¾ç¸±ï¼Œæé†’ä½ å›åˆ°ä¸­é–“å€¼ï¼Œç…§é¡§èº«å¿ƒã€‚"
      },
      {
        name: "æƒ¡é­”",
        tag: "æŸç¸›ãƒ»æ…¾æœ›ãƒ»å£“åŠ›",
        icon: "ğŸ˜ˆ",
        upright: "æ­£ä½ï¼šçœ‹è¦‹è‡ªå·±è¢«ä»€éº¼ç¶ä½ï¼ˆç¿’æ…£ã€å£“åŠ›ã€é—œä¿‚ï¼‰ï¼Œæ˜¯æ”¹è®Šçš„ç¬¬ä¸€æ­¥ã€‚",
        reversed: "é€†ä½ï¼šæœ‰æ©Ÿæœƒé¬†é–‹æ·é–ï¼Œåªè¦ä½ é¡˜æ„å°è‡ªå·±å¦èª ï¼Œæ…¢æ…¢è„«é›¢æ¶ˆè€—çš„æ¨¡å¼ã€‚"
      },
      {
        name: "é«˜å¡”",
        tag: "çªè®Šãƒ»è¦ºé†’",
        icon: "ğŸ°",
        upright: "æ­£ä½ï¼šçªç„¶çš„è®ŠåŒ–æ‰“äº‚åŸæœ¬çš„è¨ˆç•«ï¼Œä½†ä¹Ÿæ‰“ç ´èˆŠæœ‰ã€ä¸é©åˆçš„æ±è¥¿ã€‚",
        reversed: "é€†ä½ï¼šä¸€ç›´å®³æ€•å´©å£ã€å»åˆç·ŠæŠ“ä¸æ”¾ï¼Œæé†’ä½ å­¸ç¿’ã€Œå®‰å…¨åœ°æ”¾ä¸‹ã€ã€‚"
      },
      {
        name: "æ˜Ÿæ˜Ÿ",
        tag: "å¸Œæœ›ãƒ»ç™‚ç™’ãƒ»éˆæ„Ÿ",
        icon: "â­",
        upright: "æ­£ä½ï¼šæº«æŸ”çš„å¸Œæœ›æ­£åœ¨é è¿‘ï¼Œä½ å€¼å¾—è¢«æº«æŸ”å°å¾…ï¼Œæ…¢æ…¢ç™‚ç™’å°±å¥½ã€‚",
        reversed: "é€†ä½ï¼šæš«æ™‚çœ‹ä¸åˆ°å…‰ï¼Œä½†æ˜Ÿæ˜Ÿé‚„åœ¨ï¼Œåªæ˜¯è¢«é›²é®ä½äº†ï¼Œçµ¦è‡ªå·±å¤šä¸€é»æ™‚é–“ã€‚"
      },
      {
        name: "æœˆäº®",
        tag: "æƒ…ç·’ãƒ»è¿·éœ§ãƒ»å¤¢å¢ƒ",
        icon: "ğŸŒ™",
        upright: "æ­£ä½ï¼šæƒ…ç·’èµ·ä¼è¼ƒå¤§ï¼Œé©åˆè¨˜éŒ„å¤¢å¢ƒèˆ‡æ„Ÿå—ï¼Œç•™æ„ç›´è¦ºçµ¦çš„è¨Šæ¯ã€‚",
        reversed: "é€†ä½ï¼šæƒ³åƒèˆ‡ç¾å¯¦æœ‰é»æ··åœ¨ä¸€èµ·ï¼Œè©¦è‘—ç”¨ç°¡å–®çš„äº‹å¯¦å¹«è‡ªå·±è¸©ç©©åœ°æ¿ã€‚"
      },
      {
        name: "å¤ªé™½",
        tag: "å–œæ‚…ãƒ»æˆåŠŸãƒ»è‡ªä¿¡",
        icon: "â˜€ï¸",
        upright: "æ­£ä½ï¼šèƒ½é‡æ˜äº®ã€æœ‰æ©Ÿæœƒè¢«çœ‹è¦‹èˆ‡è‚¯å®šï¼Œå‹‡æ•¢åœ°å±•ç¾çœŸå¯¦çš„è‡ªå·±ã€‚",
        reversed: "é€†ä½ï¼šæœ‰é»ç´¯ã€æœ‰é»æä¸èµ·å‹ï¼Œæé†’ä½ å…ˆä¼‘æ¯å……é›»ï¼Œå†ä¾†è¿½é€ç›®æ¨™ä¹Ÿä¸é²ã€‚"
      },
      {
        name: "å¯©åˆ¤",
        tag: "é†’æ‚Ÿãƒ»å¬å–šãƒ»ç¬¬äºŒæ¬¡æ©Ÿæœƒ",
        icon: "ğŸ“£",
        upright: "æ­£ä½ï¼šéå»çš„ç¶“é©—åœ¨å‘¼å–šä½ åšå‡ºæ–°çš„é¸æ“‡ï¼Œæ˜¯é‡æ–°é–‹å§‹çš„å¥½æ™‚æ©Ÿã€‚",
        reversed: "é€†ä½ï¼šå°éå»éåº¦ç³¾çµï¼Œè®“ä½ é²é²ç„¡æ³•å¾€å‰ï¼Œè©¦è‘—åŸè«’è‡ªå·±èµ°éŒ¯çš„è·¯ã€‚"
      },
      {
        name: "ä¸–ç•Œ",
        tag: "å®Œæˆãƒ»æ•´åˆãƒ»åœ“æ»¿",
        icon: "ğŸŒ",
        upright: "æ­£ä½ï¼šä¸€å€‹é‡è¦çš„éšæ®µå°‡è¿‘å®Œæˆï¼Œä½ å­¸åˆ°çš„æ±è¥¿æœƒæˆç‚ºä¸‹ä¸€æ®µæ—…ç¨‹çš„å¯¶è—ã€‚",
        reversed: "é€†ä½ï¼šé‚„å·®æœ€å¾Œä¸€å°æ­¥ï¼Œæé†’ä½ ç©©ç©©æ”¶å°¾ï¼Œä¸è¦æ€¥è‘—æ”¾æ£„ã€‚"
      }
    ];

    const startBtn = document.getElementById("startBtn");
    const starLayer = document.getElementById("starLayer");
    const bearDialog = document.getElementById("bearDialog");
    const bearMessageEl = document.getElementById("bearMessage");
    const againBtn = document.getElementById("againBtn");

    const slots = {
      past:  document.querySelector('.card-slot[data-position="past"]  .card'),
      present: document.querySelector('.card-slot[data-position="present"] .card'),
      future: document.querySelector('.card-slot[data-position="future"] .card')
    };

    // reading = { past: { card, reversed }, present: {...}, future: {...} }
    let reading = null;
    let flippedCount = 0;
    let gameReady = false;

    // å·¥å…·ï¼šæ´—ç‰Œ
    function shuffle(array) {
      const arr = array.slice();
      for (let i = arr.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
      }
      return arr;
    }

    // å·¥å…·ï¼šç”¢ç”Ÿæ˜Ÿæ˜Ÿç²’å­
    function spawnStarBurst(centerX, centerY, count = 8) {
      const rect = starLayer.getBoundingClientRect();
      for (let i = 0; i < count; i++) {
        const star = document.createElement("div");
        star.className = "star";
        const offsetX = (Math.random() - 0.5) * 40;
        const offsetY = (Math.random() - 0.5) * 10;
        star.style.left = (centerX - rect.left + offsetX) + "px";
        star.style.top  = (centerY - rect.top + offsetY) + "px";
        const delay = (Math.random() * 0.25).toFixed(2);
        star.style.animationDelay = delay + "s";
        starLayer.appendChild(star);
        star.addEventListener("animationend", () => {
          star.remove();
        });
      }
    }

    // è¨­å®šå–®å¼µå¡ç‰‡å…§å®¹ï¼ˆå«æ­£é€†ä½ï¼‰
    function fillCard(cardEl, slotData) {
      const { card, reversed } = slotData;
      const nameEl    = cardEl.querySelector(".card-name");
      const tagEl     = cardEl.querySelector(".card-tag");
      const meaningEl = cardEl.querySelector(".card-meaning");
      const iconEl    = cardEl.querySelector(".card-icon");

      cardEl.classList.toggle("is-reversed", reversed);

      nameEl.textContent    = card.name + (reversed ? "ï¼ˆé€†ä½ï¼‰" : "ï¼ˆæ­£ä½ï¼‰");
      tagEl.textContent     = card.tag;
      meaningEl.textContent = reversed ? card.reversed : card.upright;
      iconEl.textContent    = card.icon;
    }

    // ç”¢ç”Ÿç†Šç†Šç¸½çµæ–‡å­—
    function buildBearMessage(reading) {
      function label(slot) {
        return slot.card.name + (slot.reversed ? "ï¼ˆé€†ä½ï¼‰" : "ï¼ˆæ­£ä½ï¼‰");
      }
      return (
        `éå»çš„ä½ç½®æŠ½åˆ°ï¼š${label(reading.past)}ã€‚\n` +
        `ç¾åœ¨çš„ä½ç½®æŠ½åˆ°ï¼š${label(reading.present)}ã€‚\n` +
        `æœªä¾†çš„ä½ç½®æŠ½åˆ°ï¼š${label(reading.future)}ã€‚\n\n` +
        `ğŸ» æ‘é•·ç†Šç†Šæƒ³èªªï¼š\nç‰Œåªæ˜¯æé†’ï¼Œä¸æ˜¯å‘½ä»¤ã€‚è«‹æŠŠå®ƒç•¶ä½œä¸€å€‹æº«æŸ”çš„æŒ‡å¼•ï¼ŒçœŸæ­£çš„é¸æ“‡é‚„æ˜¯åœ¨ä½ æ‰‹ä¸Šå–”ã€‚`
      );
    }

    // é–‹å§‹ä¸€æ¬¡æ–°çš„å åœ
    function startReading() {
      const shuffled = shuffle(tarotCards);

      // ä¸‰å¼µç‰Œ + å„è‡ªéš¨æ©Ÿæ­£ä½ï¼é€†ä½
      reading = {
        past:    { card: shuffled[0], reversed: Math.random() < 0.5 },
        present: { card: shuffled[1], reversed: Math.random() < 0.5 },
        future:  { card: shuffled[2], reversed: Math.random() < 0.5 }
      };
      flippedCount = 0;
      gameReady = true;

      // å°‡ä¸‰å¼µç‰Œå¾©åŸæˆèƒŒé¢ & å‡ºå ´å‹•ç•«
      Object.entries(slots).forEach(([key, cardEl]) => {
        cardEl.classList.remove("flipped", "is-reversed");
        cardEl.style.pointerEvents = "auto";
        cardEl.classList.remove("show");
        void cardEl.offsetWidth; // é‡æ–°è§¸ç™¼å‹•ç•«
        cardEl.classList.add("show");
        fillCard(cardEl, reading[key]);
      });

      // éš±è—ç†Šç†Šå°è©±
      bearDialog.classList.add("hidden");

      // æ˜Ÿæ˜Ÿå°å™´ç™¼
      const rect = startBtn.getBoundingClientRect();
      spawnStarBurst(rect.left + rect.width / 2, rect.top);

      // æŒ‰éˆ•é–å®šï¼Œé¿å…é€£æŒ‰
      startBtn.disabled = true;
      setTimeout(() => {
        startBtn.disabled = false;
      }, 1200);
    }

    // ç¶å®šå¡ç‰‡é»æ“Šäº‹ä»¶
    function bindCardEvents() {
      Object.entries(slots).forEach(([key, cardEl]) => {
        cardEl.addEventListener("click", () => {
          if (!gameReady) return;
          if (cardEl.classList.contains("flipped")) return;

          cardEl.classList.add("flipped");
          flippedCount++;

          // åœ¨å¡ç‰‡é™„è¿‘å™´ç™¼æ˜Ÿæ˜Ÿ
          const rect = cardEl.getBoundingClientRect();
          spawnStarBurst(rect.left + rect.width / 2, rect.top + rect.height / 2, 10);

          if (flippedCount === 3) {
            setTimeout(() => {
              bearMessageEl.textContent = buildBearMessage(reading);
              bearDialog.classList.remove("hidden");
              gameReady = false;
            }, 600);
          }
        });
      });
    }

    // æŒ‰éˆ•ç¶å®š
    startBtn.addEventListener("click", startReading);
    againBtn.addEventListener("click", startReading);

    // åˆå§‹åŒ–
    bindCardEvents();
  </script>
</body>
</html>